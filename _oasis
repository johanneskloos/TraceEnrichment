OASISFormat: 0.4
Name:        js-trace-enrichment
Version:     0.1
Synopsis:    Trace enrichment for JavaScript execution traces.
Authors:     Johannes Kloos
License:     MIT
Plugins:     META (0.4), StdFiles (0.4)
FilesAB:     compilationConfig.ml.ab

Library "js-enrichment"
  Path:       .
  BuildTools: ocamlbuild
  Install:    true
  XMETAEnable: true
  XMETADescription: Trace enrichment for JavaScript traces
  BuildDepends: yojson, str, lwt.ppx, lwt, fmt, batteries
  Modules:    CalculatePointsTo, CalculateVersions, CleanTrace, 
    LocalFacts, PointsTo, Reference, RichTrace, Streaming, Trace,
    TraceTypes, Types, Debug, StringMap, IntMap, IntIntMap,
    IntIntSet

Document "js-enrichment-api"
  Type:       ocamlbuild (0.4)
  BuildTools: ocamldoc, ocamlbuild
  Title:      API reference for js-enrichment
  XOcamlbuildPath: .
  XOcamlbuildModules:    CalculatePointsTo, CalculateVersions, CleanTrace, 
    LocalFacts, PointsTo, Reference, RichTrace, Streaming, Trace,
    TraceTypes, Types, Debug, StringMap, IntMap, IntIntMap,
    IntIntSet

Library "js-enrichment-xhr"
  Path:       .
  BuildTools: ocamlbuild
  Install:    true
  XMETAEnable: true
  FindLibParent: js-enrichment
  XMETADescription: Trace enrichment server for JavaScript traces
  BuildDepends: yojson, str, lwt.ppx, lwt, fmt, batteries, cohttp, fileutils, uuidm, conduit
  Modules:    Config, CompilationConfig, TraceCollector, TraceStream
  DataFiles:  generic-tracer.js
  
Library "js-enrichment.test"
  Path:       .
  BuildTools: ocamlbuild
  Install:    true
  XMETAEnable: true
  XMETADescription: Trace enrichment for JavaScript traces - test data
  BuildDepends: yojson, str, lwt, kaputt, js-enrichment, fmt, batteries
  Modules:    TestBaseData

Flag prettyprint
  Description: build the pretty-printers for traces.
  Default:     false

Executable "pptrace"
  Path:         .
  BuildTools:   ocamlbuild
  MainIs:       pptrace.ml
  Install$:     flag(prettyprint)
  BuildDepends: js-enrichment
  CompiledObject: best

Executable "pprichtrace"
  Path:         .
  BuildTools:   ocamlbuild
  MainIs:       pprichtrace.ml
  Install$:     flag(prettyprint)
  BuildDepends: js-enrichment
  CompiledObject: best

Executable "ppcleantrace"
  Path:         .
  BuildTools:   ocamlbuild
  MainIs:       ppcleantrace.ml
  Install$:     flag(prettyprint)
  BuildDepends: js-enrichment
  CompiledObject: best

Executable "unittests"
  Path:       .
  BuildTools: ocamlbuild
  Install:    false
  Build$:     flag(tests)
  MainIs:     unittests.ml
  BuildDepends: kaputt, lwt, yojson, str, fmt, batteries

Test "unittests"
  Command:    $unittests
  Run:        true

Executable "cleantrace_test"
  Install:    false
  Build$:     flag(tests)
  MainIs:     cleantrace_test.ml
  BuildDepends: js-enrichment
  Path:       .
  BuildTools: ocamlbuild
  CompiledObject: best

Executable "richtrace_test"
  Install:    false
  Build$:     flag(tests)
  MainIs:     richtrace_test.ml
  BuildDepends: js-enrichment
  Path:       .
  BuildTools: ocamlbuild
  CompiledObject: best

Executable "synthesize_test"
  Install:    false
  Build$:     flag(tests)
  MainIs:     cleanTrace_unit_synthesize.ml
  BuildDepends: js-enrichment, kaputt
  Path:       .
  BuildTools: ocamlbuild
  CompiledObject: best

Test "synthesize_test"
  Command:    $synthesize_test
  Run:        true
